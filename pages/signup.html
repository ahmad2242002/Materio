<!DOCTYPE html>
<html>

<style>
    #map {
        height: 200px;
        width: 600px;
    }

    input[type=radio] {
        width: 15px;
        height: 15px;

    }

    body {
        background-image: url(https://proest.com/wp-content/uploads/2022/11/Building-Construction-Process-From-Start-To-Finish.jpg);
        background-repeat: no-repeat;
        background-size: 100% 100%;
    }

    .register {
        background: -webkit-linear-gradient(left, #96af31, #00c6ff);
        margin-top: 3%;
        padding: 3%;
    }

    .register-left {
        text-align: center;
        color: #fff;
        margin-top: 4%;
    }

    .register-left input {
        border: none;
        border-radius: 1.5rem;
        padding: 2%;
        width: 60%;
        background: #f8f9fa;
        font-weight: bold;
        color: #383d41;
        margin-top: 30%;
        margin-bottom: 3%;
        cursor: pointer;
    }

    .register-right {
        background: #f8f9fa;
        border-top-left-radius: 10% 50%;
        border-bottom-left-radius: 10% 50%;
    }

    .register-left img {
        margin-top: 15%;
        margin-bottom: 5%;
        width: 25%;
        -webkit-animation: mover 2s infinite alternate;
        animation: mover 1s infinite alternate;
    }

    @-webkit-keyframes mover {
        0% {
            transform: translateY(0);
        }

        100% {
            transform: translateY(-20px);
        }
    }

    @keyframes mover {
        0% {
            transform: translateY(0);
        }

        100% {
            transform: translateY(-20px);
        }
    }

    .register-left p {
        font-weight: lighter;
        padding: 12%;
        margin-top: -9%;
    }

    .register .register-form {
        padding: 10%;
        margin-top: 10%;
    }

    .btnRegister {
        float: right;
        margin-top: 10%;
        border: none;
        border-radius: 1.5rem;
        padding: 2%;
        background: #0062cc;
        color: #fff;
        font-weight: 600;
        width: 50%;
        cursor: pointer;
    }

    .register .nav-tabs {
        margin-top: 3%;
        border: none;
        background: #0062cc;
        border-radius: 1.5rem;
        width: 28%;
        float: right;
    }

    .register .nav-tabs .nav-link {
        padding: 2%;
        height: 34px;
        font-weight: 600;
        color: #fff;
        border-top-right-radius: 1.5rem;
        border-bottom-right-radius: 1.5rem;
    }

    .register .nav-tabs .nav-link:hover {
        border: none;
    }

    .register .nav-tabs .nav-link.active {
        width: 100px;
        color: #0062cc;
        border: 2px solid #0062cc;
        border-top-left-radius: 1.5rem;
        border-bottom-left-radius: 1.5rem;
    }

    .register-heading {
        text-align: center;
        margin-top: 8%;
        margin-bottom: -15%;
        color: #495057;
    }

    .hidden {
        display: none;
    }

    .divblur {
        filter: blur(5px);
        /* Adjust the blur amount as needed */
    }

    .otpdivpos {
        border: 1px black solid;
        position: absolute;
        z-index: 100;
        width: 20%;
        margin-left: 50%;
        margin-top: 14%;
        text-align: center;
        padding: 10px;
    }

    .otpblocks {
        display: flex;
        justify-content: space-around;
        padding: 5px;
        height: 60px;
    }
</style>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Sign up</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/css/bootstrap4-toggle.min.css"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
</head>

<body>
    <div id="otpdiv" class="otpdivpos hidden">
        <h3>Confirm OTP</h3>
        <div class="row register-form">
            <div class="col-md-12">
                <div class="form-group">
                    <div class="otpblocks">
                        <input type="text" id="otpnumber1" name="otpnumber1" class="form-control m-1 w-25 h-100" maxlength="1"/>
                        <input type="text" id="otpnumber2" name="otpnumber2" class="form-control m-1 w-25 h-100" maxlength="1"/>
                        <input type="text" id="otpnumber3" name="otpnumber3" class="form-control m-1 w-25 h-100" maxlength="1"/>
                        <input type="text" id="otpnumber4" name="otpnumber4" class="form-control m-1 w-25 h-100" maxlength="1"/>
                    </div>

                </div>
                <div class="form-group">
                    <input type="submit" id="projectmaterial" class="btn btn-success m-1" value="Sign UP"
                        onclick="submit()">
                </div>
            </div>
        </div>
    </div>
    <div class="container register" id="registerdiv">
        <div class="row">
            <div class="col-md-3 register-left">
                <img style="width: 150px; height: 150px;"
                    src="https://assets-news.housing.com/news/wp-content/uploads/2022/10/12093520/Types-of-building-materials.jpg"
                    alt="" />
                <h3>Welcome!</h3>
                <p>Register yourself in our honourable company</p>
                <input type="submit" onclick="checkotp()" value="Register" /><br />
            </div>
            <div class="col-md-9 register-right">
                <div class="form-group" style="float: right;">
                    <div class="maxl" style="margin-left: 10px;">
                        <label class="radio inline">
                            <input type="radio" id="user" class="domain" name="domain" value="user" checked
                                onclick="userenter()">
                            <span> User </span>
                        </label>
                        <label class="radio inline">
                            <input type="radio" id="company" class="domain" name="domain" value="company"
                                onclick="adminenter()">
                            <span> Company </span>
                        </label>
                    </div>
                </div>
                <div class="tab-content" id="myTabContent">
                    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                        <h3 class="register-heading">Registeration Form</h3>
                        <form enctype="multipart/form-data">
                            <div class="row register-form">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <input type="text" id="firstname" name="firstname" class="form-control"
                                            placeholder="First Name *" value="" />
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="lastname" name="lastname" class="form-control"
                                            placeholder="Last Name *" value="" />
                                    </div>
                                    <div class="form-group">
                                        <input type="password" id="password" name="password" class="form-control"
                                            placeholder="Password *" value="" />
                                    </div>
                                    <div class="form-group">
                                        <input type="password" id="cpassword" name="cpassword" class="form-control"
                                            placeholder="Confirm Password *" value="" />
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="companyname" name="companyname" class="form-control"
                                            placeholder="Company name *" value="" style="display: none;" />
                                    </div>
                                    <div class="form-group">
                                        <label for="image">Select an Image</label>
                                        <input type="file" name="image" class="form-control" id="image1"
                                            value=""></input>
                                    </div>
                                    <br>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <input type="email" id="email" name="email" class="form-control"
                                            placeholder="Your Email *" value="" />
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="phoneno" minlength="10" maxlength="10" name="phoneno"
                                            class="form-control" placeholder="Your Phone *" value="" />
                                    </div>
                                    <div>
                                        <input type="hidden" id="lattitude" />
                                        <input type="hidden" id="longitude" />
                                        <input id="pac-input" style="margin-bottom: 5px" class="form-control"
                                            placeholder="Search your location on Map (Pointer is also movable)">
                                        <label style="color:red;font-size:12px; display: none;"
                                            id="pacinputwarning">This is a Required Field.</label>
                                        <BR>
                                        <div class="row">
                                            <div id="map" style="margin-bottom: 10px"></div>
                                        </div>
                                        <div class="row">
                                            <input type="hidden" id="lattitude" />
                                            <input type="hidden" id="longitude" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                    </div>
                </div>
                </form>
            </div>
        </div>
    </div>

    </div>
    <script type="text/javascript" src="jquery-3.6.0.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script>
        var otpcode;
        function adminenter() {
            document.getElementById("companyname").style.display = "block";
            document.getElementById("email").placeholder = "Company Email *";
            document.getElementById("phoneno").placeholder = "Company Phone no *";
        }
        function userenter() {
            document.getElementById("companyname").style.display = "none";
            document.getElementById("email").placeholder = "Your Email *";
            document.getElementById("phoneno").placeholder = "Your Phone no *";
        }
        function submit() {
            var code = "";
            for (var i = 1; i <= 4; i++) {
                code = code + $("#otpnumber" + i).val();
            }
            if (code == otpcode) {
                var companyname;
                var latitude = document.getElementById("lattitude").value;
                var longitude = document.getElementById("longitude").value;
                var input = document.getElementById("pac-input").value;
                var firstname = $("#firstname").val();
                var lastname = $("#lastname").val();
                var password = $("#password").val();
                var cpassword = $("#cpassword").val();
                var domain = $("input[type=radio][name=domain]:checked").val();
                if (domain == "company") {
                    companyname = $("#companyname").val();
                }
                else {
                    companyname = "none";
                }
                var email = $("#email").val();
                var phoneno = $("#phoneno").val();
                var image = $('#image1').prop("files")[0];
                var formData = new FormData();
                formData.append('firstname', firstname);
                formData.append('lastname', lastname);
                formData.append('password', password);
                formData.append('cpassword', cpassword);
                formData.append('domain', domain);
                formData.append('email', email);
                formData.append('phoneno', phoneno);
                formData.append('longitude', longitude);
                formData.append('latitude', latitude);
                formData.append('companyname', companyname);
                formData.append('image', image);
                $.ajax({
                    url: 'https://ahel-server.vercel.app/insert',
                    type: 'POST',
                    data: formData,
                    contentType: false,
                    processData: false,
                    success: function (result) {
                        var d = JSON.parse(result);
                        var res = d.res;
                        if (res != -1) {
                            location.href = "../signin.html";
                        }
                        else {
                            alert("Password and Confirm Password Not Same");
                        }

                    },
                    error: function () {
                        alert('error');
                    }
                });
            }
            else {
                alert("Wrong OTP");
            }
        }




        function validate(evt) {
            var theEvent = evt || window.event;

            // Handle paste
            if (theEvent.type === 'paste') {
                key = event.clipboardData.getData('number');
            } else {
                // Handle key press
                var key = theEvent.keyCode || theEvent.which;
                key = String.fromCharCode(key);
            }
            var regex = /[0-9]/;
            if (!regex.test(key)) {
                theEvent.returnValue = false;
                if (theEvent.preventDefault) theEvent.preventDefault();
            }
        }


        var map;

        function initAutocomplete() {

            var map = new google.maps.Map(document.getElementById('map'), {
                center: {
                    lat: 30.3753,
                    lng: 69.3451
                },
                zoom: 5
            });


            var options = {
                componentRestrictions: { country: "pk" }
            };

            var input = (document.getElementById('pac-input'));
            var autocomplete = new google.maps.places.Autocomplete(input, options);

            autocomplete.bindTo('bounds', map);

            var infowindow = new google.maps.InfoWindow();

            var marker = new google.maps.Marker({
                draggable: true,
                map: map

            });


            autocomplete.addListener('place_changed', function () {

                var place = autocomplete.getPlace();
                var lattitude = place.geometry.location.lat();
                var longitude = place.geometry.location.lng();

                google.maps.event.addListener(marker, 'dragend', function (event) {
                    document.getElementById("lattitude").value = this.getPosition().lat();
                    document.getElementById("longitude").value = this.getPosition().lng();

                    //Marker Location Changed

                    document.getElementById("lattitude").value = this.getPosition().lat();


                    document.getElementById("longitude").value = this.getPosition().lng();


                });

                //alert(lattitude + ' ' + longitude);
                document.getElementById("lattitude").value = lattitude;
                document.getElementById("longitude").value = longitude;


                //Selected Place Changed

                //alert("Hello");

                infowindow.close();
                marker.setVisible(false);
                var place = autocomplete.getPlace();
                if (!place.geometry) {
                    window.alert("Autocomplete's returned place contains no geometry");
                    return;
                }

                // If the place has a geometry, then present it on a map.
                if (place.geometry.viewport) {
                    map.fitBounds(place.geometry.viewport);
                } else {
                    map.setCenter(place.geometry.location);
                    map.setZoom(17);
                    // Why 17? Because it looks good.
                }

                marker.setPosition(place.geometry.location);
                marker.setVisible(true);

                var address = '';
                if (place.address_components) {
                    address = [(place.address_components[0] && place.address_components[0].short_name || ''), (place.address_components[1] && place.address_components[1].short_name || ''), (place.address_components[2] && place.address_components[2].short_name || '')].join(' ');
                }

                infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
                infowindow.open(map, marker);



                // iterate through address_component array



            });



        }



        function muSubFun() {
            var latitude = document.getElementById("lattitude").value;
            var longitude = document.getElementById("longitude").value;
            var input = document.getElementById("pac-input").value;


            alert(latitude, longitude);

            /*	
                $.post("controller.php", {
                    
                    
                    lat : 1,
                    lon : 2,
                    inp : 'kjsdkf afkjdkdajf jkdfakdfkad hkdafhk',
                    rol : 3,			
                    
                    action : 'adddata'
                    
                }, function(result) {
                
                    
                    alert("Datab Added");
                    
                });		
                
                */


        }


        function checkotp() {
            document.getElementById("otpdiv").classList.remove("hidden");
            document.getElementById("registerdiv").classList.add("divblur");
            var email = $("#email").val();

            var data = { email: email };
            var post = JSON.stringify(data);
            $.ajax({
                url: 'https://ahel-server.vercel.app/sendotp',
                headers: {
                    'Content-Type': 'application/json'
                },
                type: 'POST',
                contentType: 'application/json',
                data: post,
                success: function (result) {
                    otpcode = result.otpCode;
                },
                error: function () {
                    alert('error');
                }
            });
        }


    </script>

    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB9irjntPHdEJf024h7H_XKpS11OeW1Nh8&libraries=places&callback=initAutocomplete"
        async defer></script>
</body>

</html>